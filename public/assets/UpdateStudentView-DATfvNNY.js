import{r,a as D,u as L,j as e,L as f}from"./index-DjI7ZG_S.js";import{u as $}from"./http-hook-D44mLOTF.js";import{D as w}from"./DynamicForm-D8f1P9ga.js";import{E as I}from"./ErrorCard-Drp33CnV.js";import{M as O}from"./ModalBottomClose-De-hj65x.js";import{F as P}from"./FileUpload-CvOoBl69.js";import{I as T}from"./iconify-BsPfAMaL.js";import"./iconify-icon-C1YYA-Pd.js";const A=()=>{const[i,h]=r.useState({title:"",message:"",onConfirm:null}),[g,m]=r.useState(!1),{isLoading:t,error:l,sendRequest:d,setError:b}=$(),[x,q]=r.useState(!1),[a,j]=r.useState(),[y,N]=r.useState(),c=r.useRef(),p=D().studentId,v=L();r.useEffect(()=>{(async()=>{try{const o=await d(`http://localhost:5000/api/students/${p}`);j(o.student);const s=new Date(o.student.dateOfBirth);N(s.toISOString().split("T")[0])}catch{}})()},[d,p]);const C=async n=>{const o=`http://localhost:5000/api/students/${p}`,s=new FormData;s.append("name",n.name),s.append("dateOfBirth",n.dateOfBirth),s.append("gender",n.gender),s.append("parentName",n.parentName),s.append("address",n.address),c.current.files[0]&&s.append("image",c.current.files[0]);let u;try{u=await d(o,"PATCH",s)}catch{}h({title:"Berhasil!",message:u.message,onConfirm:()=>v(-1)}),m(!0)},k=()=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>m(!1),className:`${i.onConfirm&&l?"btn-danger-outline":"button-primary mt-0 "}`,children:i.onConfirm&&l?"Batal":"Tutup"}),i.onConfirm&&e.jsx("button",{onClick:i.onConfirm,className:"button-primary mt-0 ",children:"Ok"})]});return e.jsxs("div",{className:"m-auto max-w-md mt-14 md:mt-8",children:[e.jsxs(O,{isOpen:g,onClose:()=>m(!1),title:i.title,footer:e.jsx(k,{}),children:[t&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(f,{size:32})}),!t&&i.message]}),l&&e.jsx(I,{error:l,onClear:()=>b(null)}),e.jsx("div",{className:`pb-24 transition-opacity duration-300 ${x?"opacity-0":"opacity-100"}`,children:e.jsx(w,{customDescription:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"",children:e.jsx(P,{ref:c,accept:".jpg,.jpeg,.png",buttonLabel:e.jsx(T,{icon:"jam:upload",width:"24",height:"24"}),buttonClassName:`${t&&"hidden"} border border-gray-600 bg-gray-50 size-9 rounded-full absolute offset bottom-2 right-2 translate-x-1/2 translate-y-1/2`,imgClassName:`${t&&"animate-pulse"} mt-2 rounded-md size-32 md:size-48 shrink-0`,defaultImageSrc:a!=null&&a.image?`http://localhost:5000/api/${a.image}`:"https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png?20150327203541"})})}),subtitle:"Update Profile Peserta Didik",fields:[{name:"name",label:"Nama Lengkap",placeholder:"Nama Lengkap",type:"text",required:!0,disabled:t,value:(a==null?void 0:a.name)||""},{name:"dateOfBirth",label:"Tanggal Lahir",placeholder:"PC",type:"date",required:!0,disabled:t,value:y||""},{name:"gender",label:"Jenis Kelamin",type:"select",required:!0,disabled:t,value:(a==null?void 0:a.gender)||"",options:[{label:"Laki-Laki",value:"male"},{label:"Perempuan",value:"female"}]},{name:"parentName",label:"Nama Orang Tua",type:"text",required:!0,disabled:t,value:(a==null?void 0:a.parentName)||""},{name:"address",label:"Alamat",type:"textarea",required:!0,disabled:t,value:(a==null?void 0:a.address)||""}],onSubmit:C,disabled:t,reset:!1,footer:!1,button:e.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:e.jsx("button",{type:"submit",className:`button-primary ${t?"opacity-50 cursor-not-allowed":""}`,disabled:t,children:t?e.jsx(f,{children:"Processing..."}):"Update"})})})})]})};export{A as default};
