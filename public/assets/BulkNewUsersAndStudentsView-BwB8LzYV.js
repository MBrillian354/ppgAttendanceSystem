import{r as e,u as S,A,j as t,L as N}from"./index-DjI7ZG_S.js";import{u as C}from"./http-hook-D44mLOTF.js";import{D as T}from"./DynamicForm-D8f1P9ga.js";import{E as v}from"./ErrorCard-Drp33CnV.js";import{M as G}from"./ModalBottomClose-De-hj65x.js";import"./iconify-icon-C1YYA-Pd.js";const P=()=>{const[o,c]=e.useState([]),{isLoading:a,error:u,sendRequest:n,setError:m}=C(),[d,p]=e.useState(),[h,l]=e.useState(!1),[f,b]=e.useState(!1);e.useState(""),e.useState(""),e.useState("student");const[q,g]=e.useState(""),x=S(),y=e.useContext(A);e.useEffect(()=>{(async()=>{try{const r=await n("http://localhost:5000/api/levels/branches/sub-branches");c(r.teachingGroups)}catch{}})()},[n]),e.useEffect(()=>{o&&p([{name:"count",label:"Jumlah Akun",placeholder:"0",type:"number",required:!0},{name:"year",type:"year",label:"Tahun",value:new Date().getFullYear(),required:!0},{name:"teachingGroupName",label:"Kelompok Ajar",type:"select",required:!0,options:o.map(({name:s})=>({label:s,value:s}))}])},[o]);const k=async s=>{if(!s.count||s.count<=0){g("Please enter a valid count.");return}const r="http://localhost:5000/api/users/bulk-create",j=JSON.stringify({year:s.year,count:s.count,teachingGroupName:s.teachingGroupName,role:"student"});let i;try{i=await n(r,"POST",j,{"Content-Type":"application/json",Authorization:"Bearer "+y.token}),b(i.message),l(!0)}catch{}};return t.jsxs("div",{className:"m-auto max-w-md mt-14 md:mt-8",children:[t.jsx(G,{isOpen:h,onClose:()=>l(!1),title:"Berhasil!",footer:t.jsx(t.Fragment,{children:t.jsx("button",{onClick:()=>{l(!1),x("/settings/users/")},className:"btn-danger-outline",children:"Tutup"})}),children:f}),t.jsx("div",{className:"px-2",children:u&&t.jsx(v,{error:u,onClear:()=>m(null)})}),t.jsx(T,{title:"Tambah Akun Peserta Didik",subtitle:"Sistem Akademik Digital",fields:d||[{name:"count",label:"Jumlah Akun",placeholder:"0",type:"text",required:!0},{name:"teachingGroupName",label:"Kelompok Ajar",placeholder:"Kelompok Ajar",type:"text",required:!0},{name:"role",label:"Jenis Akun",placeholder:"Peserta Didik",type:"text",required:!0}],onSubmit:k,disabled:a,reset:!1,footer:!1,button:t.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:t.jsx("button",{type:"submit",className:`button-primary ${a?"opacity-50 cursor-not-allowed":""}`,disabled:a,children:a?t.jsx(N,{children:"Processing..."}):"Tambah"})})})]})};export{P as default};
