import{r,a as k,u as D,j as e,L as f}from"./index-D_ufnm_m.js";import{u as L}from"./http-hook-Bu37qFrk.js";import{D as $}from"./DynamicForm-tTOpBJS-.js";import{E as I}from"./ErrorCard-BcVIfwSZ.js";import{M as O}from"./ModalBottomClose-R6qTd47U.js";import{F as P}from"./FileUpload-CH9TJsyy.js";import{I as T}from"./iconify-pGgCZ9Hv.js";import"./iconify-icon-C1YYA-Pd.js";const A=()=>{const[i,g]=r.useState({title:"",message:"",onConfirm:null}),[h,m]=r.useState(!1),{isLoading:t,error:l,sendRequest:d,setError:b}=L(),[x,q]=r.useState(!1),[a,y]=r.useState(),[j,N]=r.useState(),p=r.useRef(),c=k().studentId,v=D();r.useEffect(()=>{(async()=>{try{const o=await d(`https://ppgacademicsystem-production.up.railway.app/api/students/${c}`);y(o.student);const s=new Date(o.student.dateOfBirth);N(s.toISOString().split("T")[0])}catch{}})()},[d,c]);const C=async n=>{const o=`https://ppgacademicsystem-production.up.railway.app/api/students/${c}`,s=new FormData;s.append("name",n.name),s.append("dateOfBirth",n.dateOfBirth),s.append("gender",n.gender),s.append("parentName",n.parentName),s.append("address",n.address),p.current.files[0]&&s.append("image",p.current.files[0]);let u;try{u=await d(o,"PATCH",s)}catch{}g({title:"Berhasil!",message:u.message,onConfirm:()=>v(-1)}),m(!0)},w=()=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>m(!1),className:`${i.onConfirm&&l?"btn-danger-outline":"button-primary mt-0 "}`,children:i.onConfirm&&l?"Batal":"Tutup"}),i.onConfirm&&e.jsx("button",{onClick:i.onConfirm,className:"button-primary mt-0 ",children:"Ok"})]});return e.jsxs("div",{className:"m-auto max-w-md mt-14 md:mt-8",children:[e.jsxs(O,{isOpen:h,onClose:()=>m(!1),title:i.title,footer:e.jsx(w,{}),children:[t&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(f,{size:32})}),!t&&i.message]}),l&&e.jsx(I,{error:l,onClear:()=>b(null)}),e.jsx("div",{className:`pb-24 transition-opacity duration-300 ${x?"opacity-0":"opacity-100"}`,children:e.jsx($,{customDescription:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"",children:e.jsx(P,{ref:p,accept:".jpg,.jpeg,.png",buttonLabel:e.jsx(T,{icon:"jam:upload",width:"24",height:"24"}),buttonClassName:`${t&&"hidden"} border border-gray-600 bg-gray-50 size-9 rounded-full absolute offset bottom-2 right-2 translate-x-1/2 translate-y-1/2`,imgClassName:`${t&&"animate-pulse"} mt-2 rounded-md size-32 md:size-48 shrink-0`,defaultImageSrc:a!=null&&a.image?`https://ppgacademicsystem-production.up.railway.app/api/${a.image}`:"https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png?20150327203541"})})}),subtitle:"Update Profile Peserta Didik",fields:[{name:"name",label:"Nama Lengkap",placeholder:"Nama Lengkap",type:"text",required:!0,disabled:t,value:(a==null?void 0:a.name)||""},{name:"dateOfBirth",label:"Tanggal Lahir",placeholder:"PC",type:"date",required:!0,disabled:t,value:j||""},{name:"gender",label:"Jenis Kelamin",type:"select",required:!0,disabled:t,value:(a==null?void 0:a.gender)||"",options:[{label:"Laki-Laki",value:"male"},{label:"Perempuan",value:"female"}]},{name:"parentName",label:"Nama Orang Tua",type:"text",required:!0,disabled:t,value:(a==null?void 0:a.parentName)||""},{name:"address",label:"Alamat",type:"textarea",required:!0,disabled:t,value:(a==null?void 0:a.address)||""}],onSubmit:C,disabled:t,reset:!1,footer:!1,button:e.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:e.jsx("button",{type:"submit",className:`button-primary ${t?"opacity-50 cursor-not-allowed":""}`,disabled:t,children:t?e.jsx(f,{children:"Processing..."}):"Update"})})})})]})};export{A as default};
