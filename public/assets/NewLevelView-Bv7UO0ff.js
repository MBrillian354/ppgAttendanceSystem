import{r as t,A as S,u as P,j as e,L as u}from"./index-DjI7ZG_S.js";import{u as w}from"./http-hook-D44mLOTF.js";import{D as B}from"./DynamicForm-D8f1P9ga.js";import{E}from"./ErrorCard-Drp33CnV.js";import{M as L}from"./ModalBottomClose-De-hj65x.js";import"./iconify-icon-C1YYA-Pd.js";const I=()=>{const[p,n]=t.useState(!1),[h,b]=t.useState(""),[r,f]=t.useState(!0),[x,c]=t.useState(!1),{isLoading:s,error:m,sendRequest:l,setError:y}=w(),[i,g]=t.useState([]),[j,C]=t.useState();t.useContext(S);const N=P(),T=[{name:"name",label:"Nama PC",placeholder:"Nama PC",type:"text",required:!0},{name:"address",label:"Alamat PC",placeholder:"Alamat Lengkap",type:"text",required:!0}];t.useEffect(()=>{(async()=>{try{const o=await l("http://localhost:5000/api/levels/branches/");g(o.branches)}catch{}})()},[l]),t.useEffect(()=>{i&&C([{name:"name",label:"Nama Kelompok Ajar",placeholder:"Nama Kelompok Ajar",type:"text",required:!0},{name:"address",label:"Alamat Kelompok Ajar",placeholder:"Alamat Lengkap",type:"text",required:!0},{name:"branch",label:"PC",type:"select",required:!0,options:i.map(({name:a})=>({label:a,value:a}))}])},[i]);const v=async a=>{const o=r?"http://localhost:5000/api/levels/branches":"http://localhost:5000/api/levels/branches/sub-branches",k=JSON.stringify(r?{name:a.name,address:a.address}:{name:a.name,address:a.address,branchName:a.branch});let d;try{d=await l(o,"POST",k,{"Content-Type":"application/json"}),b(d.message),n(!0)}catch{}},A=()=>{c(!0),setTimeout(()=>{f(a=>!a),c(!1)},200)};return e.jsxs("div",{className:"m-auto max-w-md mt-14 md:mt-8",children:[e.jsx(L,{isOpen:p,onClose:()=>n(!1),title:"Berhasil!",footer:e.jsx(e.Fragment,{children:e.jsx("button",{onClick:()=>{n(!1),N("/settings/levels/")},className:"btn-danger-outline",children:"Tutup"})}),children:h}),e.jsxs("div",{className:`pb-24 transition-opacity duration-300 ${x?"opacity-0":"opacity-100"}`,children:[m&&e.jsx("div",{className:"mx-2",children:e.jsx(E,{error:m,onClear:()=>y(null)})}),e.jsx(B,{title:r?"Tambah PC":"Tambah Kelompok Ajar",subtitle:"Sistem Akademik Digital",fields:r?T:j,onSubmit:v,disabled:s,reset:!1,footer:!1,button:e.jsxs("div",{className:"flex flex-col justify-stretch mt-4",children:[e.jsx("button",{type:"submit",className:`button-primary ${s?"opacity-50 cursor-not-allowed":""}`,disabled:s,children:s?e.jsx(u,{children:"Processing..."}):"Tambah"}),e.jsx("button",{type:"button",onClick:A,className:`button-secondary ${s?"opacity-50 cursor-not-allowed":""}`,disabled:s,children:s?e.jsx(u,{children:"Processing..."}):r?"Tambah Kelompok Ajar":"Tambah PC"})]})})]})]})};export{I as default};
